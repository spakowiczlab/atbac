---
title: "volcanic range"
author: "Rebecca Hoyd"
date: "11/30/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(ggrepel)
```


```{r}
load("../../exploratory/data/plotdat_mouse-exp_vulcanrange.rda")

rangedat.form %>%
  drop_na(direction) %>%
  ggplot(aes(x = patval, y = -log(p.value), shape = protval)) +
  geom_point(aes(size = sizeval, color =direction)) +
  geom_text_repel(aes(label = pointlab), size = 3) +
  scale_color_brewer(palette = "Set1", name = "", labels = c("Depleted in Obese", "Enriched in Obese")) +
  scale_x_continuous(breaks = patkey$patnum, labels = patkey$patient) +
  scale_size_manual(breaks = c("a", "b", "c"), 
                    values = c(1,2,3), 
                    labels = c("<1", "<2", ">=2"),
                    name = "log2FoldChange") +
  scale_shape(name = "") +
  labs(x = "Patient") +
  theme_bw() +
  theme(text = element_text(size = 9))
ggsave("../figures/volcanic-range_mouseexp.pdf")
```

