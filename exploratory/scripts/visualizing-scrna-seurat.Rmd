---
title: "SCRNA Visualizations"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
library(ggforce)
library(viridis)
```

##load data
```{r}
scrna.data <- readRDS("/fs/ess/PAS1695/projects/atbac/data/scrna-seurat-subset.RDS")
```

##function for umaps
```{r}
umap.plot.gene <- function(geneName) {
  temp <- scrna.data 
  temp$geneExpr <- temp[[geneName]]
  
  temp %>%
  ggplot(aes(x = umap_1, y = umap_2)) + 
  geom_point(aes(colour = geneExpr)) +
  labs(x = "umap 1", y = "umap 2") +
  scale_color_viridis(direction = -1, option = "A", name = geneName) +
  theme_bw()  +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
  ggsave(paste0("../figures/singleCell/", geneName,".umap.png"), height = 5, width = 5)
}
```

##function for boxplots
```{r}
box.plot.gene <- function(geneName) {
  temp <- scrna.data
  temp$geneExpr <- temp[[geneName]] 
  
  temp %>%
    ggplot(aes(x = fct_reorder(scrna.data$`Cell Type`, geneExpr), y = geneExpr)) +
    geom_boxplot(show.legend = F) +
    labs(title = geneName, x = "cell type", y = "gene expression") +
    theme_bw()  +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

  ggsave(paste0("../figures/singleCell/", geneName,".boxplot.png"), height = 3, width = 5)
}
```

##make plots
```{r}
box.plot.gene()
umap.plot.gene()
```

